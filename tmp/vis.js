const lut = {
    "PA": [[0.0920607,0.516538,0.0361541,0.381586,0.457016,0.0377305,0.694805,0.392622,0.039436],  
    [0.0932814,0.751219,0.407128,0.480842,0.671541,0.409239,0.892949,0.586817,0.411483],    
    [0.120807,0.183308,0.198978,0.340741,0.138093,0.200175,0.582412,0.0884085,0.201491],    
    [0.0941397,0.627635,0.878577,0.483346,0.547619,0.880696,0.893882,0.463218,0.882931],    
    [0.177159,0.292753,0.212299,0.420231,0.24278,0.213623,0.683176,0.188722,0.215054],      
    [0.0943087,0.841316,0.611746,0.483839,0.761233,0.613867,0.894066,0.676896,0.616101],    
    [0.124877,0.398373,0.204735,0.407207,0.340329,0.206272,0.71261,0.277542,0.207935],      
    [0.159614,0.243548,0.0599459,0.363588,0.201614,0.0610566,0.587053,0.155672,0.0622733],  
    [0.0964668,0.655134,0.270988,0.460722,0.580248,0.272971,0.850874,0.500038,0.275096],    
    [0.12427,0.464848,0.438936,0.459236,0.395983,0.44076,0.818305,0.322164,0.442715],       
    [0.0944457,0.86177,0.634594,0.484237,0.781634,0.636716,0.894214,0.697348,0.638948],     
    [0.139519,0.284939,0.285773,0.391781,0.233078,0.287147,0.664319,0.177048,0.288631],     
    [0.149886,0.316021,0.23185,0.39746,0.265123,0.233198,0.66452,0.210219,0.234652],        
    [0.0654971,0.130163,0.204059,0.265418,0.0890619,0.205147,0.486903,0.0435276,0.206353],  
    [0.143799,0.312121,0.416647,0.430165,0.253247,0.418206,0.738152,0.18993,0.419883],      
    [0.0931812,0.572273,0.669552,0.48055,0.492635,0.671661,0.892841,0.407874,0.673906],     
    [0.166318,0.18363,0.201005,0.379734,0.139754,0.202167,0.612815,0.0918358,0.203436],     
    [0.126385,0.163575,0.178276,0.341306,0.11939,0.179446,0.579069,0.0705091,0.180741],     
    [0.0846184,0.178811,0.261875,0.318574,0.130713,0.263149,0.575612,0.0778695,0.264548],   
    [0.0942056,0.9269,0.418702,0.483538,0.846859,0.420822,0.893953,0.762483,0.423057],      
    [0.0927017,0.523767,0.623542,0.479142,0.44432,0.625647,0.892314,0.359377,0.627896],     
    [0.0946391,0.892454,0.668865,0.484797,0.812243,0.670989,0.894422,0.728029,0.67322],     
    [0.110671,0.421206,0.295196,0.413463,0.358956,0.296845,0.739882,0.291848,0.298622],     
    [0.141823,0.188281,0.209458,0.366311,0.142129,0.21068,0.612702,0.0914746,0.212022],     
    [0.105504,0.387767,0.280027,0.40424,0.326351,0.281653,0.727513,0.25989,0.283414],       
    [0.128033,0.330354,0.333733,0.422803,0.269753,0.335338,0.742232,0.204083,0.337077],     
    [0.189266,0.164432,0.0641685,0.375211,0.126205,0.0651809,0.581007,0.0838956,0.0663015], 
    [0.0944177,0.792067,0.737795,0.484156,0.711942,0.739917,0.894184,0.627645,0.74215],     
    [0.0931642,0.209273,0.0916239,0.294325,0.167917,0.0927192,0.516723,0.122195,0.0939302], 
    [0.117599,0.232947,0.100607,0.322096,0.190905,0.101721,0.546452,0.144781,0.102942],     
    [0.107407,0.491971,0.465232,0.460378,0.419405,0.467153,0.838855,0.341595,0.469214],     
    [0.0921496,0.237008,0.32427,0.35622,0.182718,0.325708,0.644061,0.123542,0.327275],      
    [0.117109,0.194745,0.142526,0.325131,0.151978,0.143658,0.554337,0.104857,0.144906],     
    [0.0936437,0.458042,0.550452,0.456701,0.383402,0.552429,0.84624,0.303318,0.55455],      
    [0.10757,0.46337,0.559665,0.470694,0.388717,0.561642,0.859916,0.308698,0.563761],       
    [0.157546,0.274469,0.206903,0.384071,0.227898,0.208137,0.628579,0.177631,0.209468],     
    [0.0904009,0.410172,0.301472,0.39843,0.346845,0.303149,0.731423,0.278386,0.304962],     
    [0.132701,0.134905,0.0940401,0.310418,0.0983692,0.0950078,0.508256,0.0576964,0.096085], 
    [0.0939363,0.131003,0.080587,0.251267,0.098658,0.0814436,0.426153,0.0627037,0.0823959], 
    [0.14106,0.391457,0.391854,0.440646,0.329866,0.393486,0.762027,0.263795,0.395236],      
    [0.155406,0.140411,0.167074,0.329336,0.104653,0.168021,0.518929,0.0656753,0.169053],    
    [0.11246,0.330305,0.31693,0.400022,0.271186,0.318495,0.711532,0.207143,0.320192],       
    [0.0942373,0.596122,0.433704,0.470438,0.51878,0.435753,0.873329,0.435951,0.437946],     
    [0.101295,0.249273,0.183448,0.339801,0.200239,0.184746,0.601155,0.146508,0.186169],     
    [0.0989825,0.54948,0.509491,0.4752,0.472135,0.51154,0.878042,0.389316,0.513733],        
    [0.0934568,0.583267,0.300863,0.445844,0.510821,0.302782,0.824117,0.433053,0.304842],    
    [0.15237,0.129276,0.0374832,0.279095,0.103223,0.0381733,0.417638,0.0747405,0.0389276],  
    [0.116569,0.376383,0.36929,0.429406,0.312067,0.370994,0.76738,0.242584,0.372834],       
    [0.135383,0.474722,0.335358,0.467776,0.406387,0.337168,0.825524,0.332839,0.339116],     
    [0.173112,0.265902,0.201002,0.411312,0.216932,0.202299,0.669908,0.163768,0.203707],     
    [0.1203,0.469922,0.251625,0.426702,0.40693,0.253294,0.75651,0.339126,0.255089],         
    [0.0942524,0.885343,0.512439,0.483675,0.805283,0.51456,0.894005,0.720925,0.516794],     
    [0.162623,0.343888,0.182373,0.420155,0.290943,0.183775,0.698853,0.233646,0.185293],     
    [0.142004,0.314255,0.144479,0.378027,0.265731,0.145764,0.633934,0.21312,0.147158],      
    [0.107404,0.526084,0.386079,0.45355,0.454921,0.387964,0.824684,0.37862,0.389985],       
    [0.121782,0.525519,0.279771,0.454834,0.457048,0.281584,0.812834,0.383448,0.283533],     
    [0.187572,0.242237,0.0650466,0.406171,0.197296,0.0662368,0.646488,0.147889,0.0675453],  
    [0.0929828,0.706844,0.399386,0.479967,0.627285,0.401493,0.892622,0.542449,0.40374],     
    [0.154154,0.273294,0.0595184,0.358595,0.231264,0.0606316,0.58112,0.185515,0.0618432],   
    [0.103808,0.681783,0.253832,0.471823,0.606124,0.255836,0.865757,0.525136,0.257981]],

    "PB": [[0.116901,0.167254,0.256562,0.342872,0.120797,0.257792,0.590677,0.0698515,0.259142],    
    [0.157297,0.181532,0.280262,0.394177,0.132833,0.281552,0.652442,0.079737,0.282958],     
    [0.0935513,0.278633,0.910016,0.479621,0.199262,0.912118,0.891641,0.114556,0.914361],    
    [0.156482,0.390773,0.272006,0.454597,0.329485,0.273629,0.77652,0.263302,0.275382],      
    [0.10643,0.250044,0.702369,0.443945,0.180656,0.704207,0.805726,0.106278,0.706177],      
    [0.10742,0.197495,0.62306,0.425973,0.132005,0.624795,0.769013,0.0614806,0.626663],      
    [0.0950842,0.31906,0.798001,0.468374,0.242317,0.800034,0.867839,0.160192,0.802209],     
    [0.163287,0.263726,0.370772,0.434391,0.20799,0.372248,0.727059,0.147822,0.373842],      
    [0.11016,0.16993,0.707293,0.440161,0.102086,0.70909,0.794082,0.0293245,0.711017],       
    [0.121916,0.504013,0.110203,0.42619,0.441458,0.11186,0.755175,0.373823,0.113651],       
    [0.109393,0.683399,0.143931,0.457004,0.611934,0.145823,0.829194,0.535417,0.14785],      
    [0.0937115,0.506177,0.900279,0.482092,0.426332,0.902394,0.893412,0.341769,0.904633],    
    [0.139374,0.505637,0.0648817,0.436336,0.444586,0.0664986,0.757387,0.378582,0.0682467],  
    [0.0915047,0.269108,0.109606,0.318196,0.222503,0.11084,0.567346,0.171281,0.112197],     
    [0.0947476,0.979413,0.570179,0.48511,0.899159,0.572305,0.894538,0.814986,0.574534],     
    [0.118119,0.432858,0.11668,0.399875,0.374933,0.118215,0.705279,0.312146,0.119877],      
    [0.0938633,0.5252,0.921533,0.482535,0.445294,0.923649,0.893578,0.360789,0.925887],      
    [0.0936453,0.391243,0.748309,0.47438,0.312969,0.750382,0.881972,0.229174,0.752602],     
    [0.0929419,0.388671,0.101581,0.355672,0.334657,0.103011,0.641493,0.275896,0.104567],    
    [0.107803,0.294707,0.752509,0.462573,0.221771,0.754441,0.842132,0.143738,0.756508],     
    [0.0910637,0.180215,0.579573,0.394969,0.117736,0.581227,0.722713,0.0503565,0.583012],   
    [0.0736329,0.140348,0.387348,0.324903,0.0886903,0.388716,0.598874,0.0323656,0.390208],  
    [0.129405,0.285105,0.492466,0.429574,0.223395,0.494101,0.752737,0.156956,0.49586],      
    [0.0936498,0.821119,0.116965,0.476622,0.742385,0.119051,0.885821,0.658259,0.121279],    
    [0.101156,0.29336,0.615672,0.436127,0.224494,0.617496,0.796321,0.150443,0.619457],      
    [0.0853661,0.203641,0.0278978,0.270842,0.165509,0.0289077,0.47762,0.122998,0.0300336],  
    [0.0943137,0.718,0.811728,0.483854,0.637915,0.813849,0.894072,0.55358,0.816083],        
    [0.122592,0.580489,0.19386,0.460664,0.510986,0.195701,0.824239,0.436239,0.197681],      
    [0.0767758,0.146176,0.407138,0.332097,0.0936853,0.408528,0.61,0.0365521,0.410041],      
    [0.136555,0.153371,0.245691,0.347083,0.110089,0.246837,0.576928,0.062836,0.248089],     
    [0.137249,0.475711,0.0822337,0.420449,0.417489,0.0837757,0.726474,0.354574,0.085442],   
    [0.101808,0.36278,0.11221,0.357806,0.31015,0.113604,0.636401,0.252875,0.11512],         
    [0.0782078,0.134275,0.381647,0.325372,0.0834613,0.382993,0.594764,0.0280778,0.38446],   
    [0.121605,0.181375,0.722746,0.456131,0.112601,0.724568,0.814687,0.0388865,0.72652],     
    [0.116931,0.544553,0.103021,0.420915,0.482058,0.104676,0.748299,0.414752,0.106458],     
    [0.0927684,0.416208,0.775949,0.479322,0.336737,0.778054,0.892376,0.251819,0.780303],    
    [0.0929419,0.432695,0.794379,0.479834,0.353155,0.796486,0.892568,0.268302,0.798733],    
    [0.0915487,0.220072,0.406353,0.369534,0.162922,0.407867,0.671855,0.100769,0.409513],    
    [0.127849,0.243704,0.441234,0.418664,0.183916,0.442818,0.733612,0.119167,0.444532],     
    [0.184168,0.297044,0.0582208,0.427046,0.247111,0.0595433,0.693659,0.192299,0.060995],   
    [0.113301,0.396392,0.114973,0.379071,0.341753,0.11642,0.667475,0.282461,0.117991],      
    [0.105569,0.405414,0.0444836,0.365301,0.352017,0.0458978,0.648105,0.293876,0.0474377],  
    [0.0857055,0.156421,0.532162,0.370587,0.0978534,0.533713,0.678093,0.0346343,0.535387],  
    [0.0929931,0.84672,0.145367,0.479989,0.767158,0.147474,0.892628,0.682325,0.149721],     
    [0.16172,0.220933,0.0352154,0.356761,0.180835,0.0362774,0.571509,0.136686,0.0374467],   
    [0.162307,0.289,0.395203,0.455175,0.22879,0.396797,0.771646,0.163728,0.398521],         
    [0.0929903,0.287232,0.919475,0.479895,0.207689,0.921582,0.892563,0.12285,0.923829],     
    [0.165735,0.27583,0.0650659,0.359293,0.236037,0.0661199,0.568752,0.192975,0.0672604],   
    [0.13058,0.220557,0.65422,0.449204,0.155052,0.655955,0.790868,0.08481,0.657815],        
    [0.131013,0.336596,0.0187403,0.346508,0.292293,0.0199136,0.580564,0.244174,0.021188],   
    [0.0927768,0.224653,0.406543,0.370025,0.167654,0.408053,0.671292,0.105718,0.409693],    
    [0.107793,0.347288,0.442848,0.424019,0.282276,0.44457,0.765283,0.212117,0.446428],      
    [0.115987,0.700345,0.0578778,0.458197,0.629991,0.0597411,0.825041,0.554573,0.0617385],  
    [0.118763,0.324042,0.419495,0.415634,0.26301,0.421111,0.735638,0.197221,0.422854],      
    [0.105132,0.588368,0.0599951,0.413991,0.524871,0.0616768,0.746263,0.45656,0.063486],    
    [0.146037,0.298784,0.402296,0.423377,0.241766,0.403806,0.721786,0.180417,0.405431],     
    [0.0651773,0.132809,0.482418,0.336138,0.0771031,0.483893,0.629644,0.0167621,0.485491],  
    [0.120379,0.253889,0.576158,0.437475,0.188698,0.577885,0.778881,0.11851,0.579744],      
    [0.123538,0.414828,0.399193,0.452906,0.347114,0.400986,0.807872,0.274138,0.402919],     
    [0.105712,0.402159,0.624894,0.464357,0.328426,0.626846,0.848729,0.249404,0.628939]],

    "DA": [[0.868502,0.370149,0.248002,0.584881,0.510235,0.236201,0.28524,0.658234,0.223733],      
    [0.863006,0.279462,0.0374734,0.630902,0.394103,0.0278159,0.383945,0.51608,0.0175405],   
    [0.399135,0.020957,0.299701,0.226595,0.106178,0.292522,0.0465467,0.195108,0.28503],     
    [0.442828,0.0237447,0.28625,0.267867,0.110162,0.27897,0.0844529,0.200754,0.271339],     
    [0.625683,0.0915407,0.196855,0.453715,0.17648,0.1897,0.271957,0.266253,0.182137],       
    [0.607937,0.0746159,0.36346,0.42768,0.163648,0.35596,0.239736,0.256478,0.34814],        
    [0.796134,0.176979,0.355344,0.597201,0.275236,0.347067,0.389653,0.377748,0.338431],     
    [0.644892,0.0393845,0.294873,0.455678,0.132841,0.287,0.256589,0.231175,0.278717],       
    [0.865272,0.215496,0.513846,0.603823,0.344631,0.502968,0.330429,0.479666,0.491593],     
    [0.900609,0.385197,0.632779,0.568494,0.549235,0.61896,0.220667,0.721034,0.604488],      
    [0.496859,0.0537139,0.255065,0.316965,0.142567,0.24758,0.126748,0.236519,0.239665],     
    [0.843397,0.461943,0.393518,0.543607,0.610015,0.381044,0.229178,0.765318,0.367961],     
    [0.531321,0.0620628,0.119386,0.387593,0.133053,0.113406,0.234784,0.208529,0.107048],    
    [0.856675,0.137692,0.445222,0.604176,0.262407,0.434716,0.339084,0.393341,0.423686],     
    [0.886149,0.523589,0.603409,0.530591,0.699206,0.588615,0.158063,0.883206,0.573115],     
    [0.841854,0.317751,0.576272,0.549401,0.4622,0.564104,0.243573,0.613254,0.551379],       
    [0.396521,0.0258049,0.232595,0.239728,0.103248,0.226072,0.0747825,0.184718,0.219208],   
    [0.855758,0.118702,0.198411,0.643283,0.223647,0.189571,0.418071,0.334884,0.1802],       
    [0.899713,0.455399,0.382533,0.58113,0.612753,0.369277,0.245954,0.778304,0.355331],      
    [0.599239,0.0485625,0.301351,0.409823,0.142119,0.29347,0.210531,0.240554,0.285178],     
    [0.466447,0.0364479,0.271964,0.295419,0.120922,0.264848,0.115688,0.209694,0.25737],     
    [0.865195,0.43984,0.509268,0.548675,0.596175,0.496098,0.216957,0.760018,0.482296],      
    [0.645778,0.0598001,0.147783,0.478112,0.142614,0.140807,0.299776,0.230698,0.133387],    
    [0.826877,0.0838078,0.30465,0.634326,0.178913,0.296638,0.432464,0.278616,0.288239],     
    [0.855969,0.268073,0.304085,0.598841,0.395073,0.293387,0.327869,0.528912,0.282112],     
    [0.893859,0.479047,0.493891,0.560638,0.643632,0.480027,0.211038,0.816307,0.46548],      
    [0.858967,0.197975,0.325357,0.620474,0.315771,0.315434,0.369548,0.439709,0.304993],     
    [0.872143,0.475407,0.618173,0.526394,0.646179,0.603787,0.164143,0.825102,0.588715],     
    [0.699276,0.0454369,0.142452,0.531366,0.128371,0.135466,0.352757,0.21659,0.128034],     
    [0.809165,0.133607,0.208676,0.604816,0.234539,0.200174,0.388809,0.34123,0.191186],      
    [0.81013,0.172265,0.191831,0.604451,0.273855,0.183273,0.387282,0.381119,0.174237],      
    [0.763152,0.133779,0.149467,0.566387,0.230965,0.14128,0.357449,0.334164,0.132587],      
    [0.75079,0.0539367,0.267109,0.561424,0.147469,0.25923,0.362062,0.245937,0.250934],      
    [0.892421,0.553657,0.707838,0.523451,0.735899,0.692486,0.137641,0.926458,0.676433],     
    [0.859788,0.155033,0.267705,0.649643,0.258828,0.258961,0.428725,0.367944,0.249769],     
    [0.72775,0.115227,0.164533,0.550975,0.20254,0.157177,0.3641,0.294841,0.149402],         
    [0.902189,0.279529,0.477387,0.611385,0.423162,0.465287,0.305986,0.574005,0.45258],      
    [0.894408,0.458719,0.604607,0.54879,0.629426,0.590226,0.18656,0.808339,0.575154],       
    [0.878408,0.311636,0.463639,0.596039,0.451104,0.45189,0.299937,0.597354,0.43957],       
    [0.878246,0.0688495,0.153278,0.685678,0.163963,0.145266,0.481071,0.265022,0.136753],    
    [0.613623,0.0681996,0.285194,0.428026,0.15987,0.277472,0.232668,0.256361,0.269344],     
    [0.905319,0.578555,0.445894,0.55378,0.752187,0.431267,0.184683,0.934492,0.41591],       
    [0.852178,0.289003,0.291987,0.606081,0.410555,0.281747,0.347427,0.53831,0.270985],      
    [0.458683,0.024954,0.10611,0.321073,0.0929221,0.100385,0.173592,0.165766,0.0942482],    
    [0.891602,0.257204,0.394592,0.615667,0.393494,0.38311,0.325227,0.536948,0.371026],      
    [0.874157,0.121098,0.369457,0.637004,0.238233,0.35959,0.387433,0.361501,0.349206],      
    [0.798132,0.0902648,0.39963,0.586289,0.194898,0.390816,0.364809,0.304292,0.381601],     
    [0.877023,0.277231,0.37334,0.61485,0.406723,0.362431,0.33943,0.542759,0.350971],        
    [0.370391,0.034726,0.0774186,0.252183,0.0931114,0.0725002,0.125365,0.15575,0.0672235],  
    [0.914789,0.597813,0.431291,0.563771,0.771187,0.416686,0.195449,0.953109,0.401361],     
    [0.817114,0.288021,0.280148,0.558589,0.415712,0.269391,0.285764,0.550466,0.258039],     
    [0.723821,0.104561,0.326918,0.54098,0.19487,0.31931,0.349842,0.289277,0.311357],        
    [0.882714,0.312062,0.349991,0.601839,0.450793,0.338304,0.305957,0.596934,0.325993],     
    [0.86511,0.0825614,0.302856,0.665597,0.181105,0.294554,0.456244,0.284509,0.285843],     
    [0.790044,0.147685,0.274493,0.590226,0.246379,0.266178,0.38042,0.350007,0.257449],      
    [0.903926,0.531373,0.47583,0.557152,0.702652,0.461401,0.193072,0.882478,0.446253],      
    [0.490927,0.0435717,0.089298,0.361161,0.107665,0.0838987,0.222754,0.176028,0.0781398],  
    [0.779542,0.0853074,0.400207,0.586181,0.180812,0.392161,0.384777,0.28029,0.383781],     
    [0.879765,0.0895181,0.225025,0.670077,0.193087,0.2163,0.448155,0.302699,0.207067],      
    [0.856561,0.386598,0.659934,0.526071,0.549833,0.646182,0.180093,0.720719,0.631787]],

    "DB": [[0.850955,0.303239,0.683962,0.541221,0.456223,0.671075,0.217713,0.616011,0.657614],     
    [0.884295,0.0658755,0.23099,0.691461,0.16112,0.222967,0.488163,0.261533,0.214508],      
    [0.538536,0.0558872,0.118601,0.396789,0.125899,0.112704,0.246203,0.200276,0.106438],    
    [0.900271,0.377234,0.0541681,0.639532,0.506018,0.0433193,0.363208,0.642501,0.0318219],  
    [0.742539,0.0461049,0.526734,0.504614,0.163621,0.516835,0.257082,0.285882,0.506535],    
    [0.91635,0.605444,0.40867,0.571869,0.77559,0.394337,0.210606,0.954025,0.379306],        
    [0.877565,0.0902647,0.800866,0.59059,0.232008,0.788926,0.293722,0.378637,0.776573],     
    [0.873828,0.330047,0.163635,0.625732,0.452586,0.153312,0.363884,0.581919,0.142417],     
    [0.841511,0.128567,0.0695701,0.653437,0.221461,0.0617446,0.453408,0.320259,0.0534218],  
    [0.848046,0.0851247,0.0909187,0.674068,0.171056,0.0836798,0.489357,0.262288,0.0759943], 
    [0.550387,0.0452802,0.0234819,0.424175,0.107619,0.0182304,0.288609,0.174578,0.0125898], 
    [0.899928,0.456792,0.859216,0.529254,0.639876,0.843793,0.142383,0.830959,0.827696],     
    [0.877138,0.163702,0.764379,0.578951,0.310983,0.751972,0.268785,0.46418,0.739067],      
    [0.889522,0.411389,0.117843,0.617062,0.545962,0.106506,0.329096,0.688194,0.0945243],    
    [0.834802,0.142411,0.78906,0.553528,0.281338,0.777357,0.262192,0.425235,0.765235],      
    [0.935456,0.417692,0.0259589,0.66806,0.549764,0.0148331,0.384939,0.689603,0.00305288],  
    [0.870459,0.226369,0.229499,0.628335,0.345959,0.219424,0.372283,0.472429,0.20877],      
    [0.858828,0.0722909,0.479177,0.620362,0.190074,0.469255,0.371174,0.313153,0.458886],    
    [0.516147,0.0494908,0.323027,0.339595,0.136693,0.315681,0.154945,0.227896,0.307998],    
    [0.52176,0.0298495,0.0408186,0.392869,0.0935111,0.0354557,0.253963,0.16212,0.0296761],  
    [0.76972,0.208343,0.180051,0.567239,0.308352,0.171626,0.353729,0.413809,0.162742],      
    [0.755242,0.0819447,0.60244,0.505983,0.205059,0.592069,0.247009,0.332971,0.581293],     
    [0.633924,0.0495781,0.553653,0.396929,0.166634,0.543792,0.151053,0.288077,0.533561],    
    [0.872325,0.249802,0.971848,0.539046,0.414416,0.95798,0.193349,0.585163,0.943597],      
    [0.669142,0.0601289,0.445556,0.457643,0.164592,0.436755,0.237117,0.273515,0.42758],     
    [0.892118,0.141432,0.898912,0.577939,0.296612,0.885839,0.252538,0.457334,0.8723],       
    [0.762845,0.0430117,0.624797,0.50734,0.169211,0.614166,0.242603,0.29997,0.603151],      
    [0.807318,0.200411,0.0958871,0.595448,0.305057,0.0870716,0.370307,0.416259,0.0777039],  
    [0.876497,0.201797,0.614724,0.585781,0.345388,0.602627,0.281636,0.495611,0.589973],     
    [0.897118,0.431482,0.894468,0.527361,0.614112,0.879083,0.141696,0.8046,0.863036],       
    [0.841414,0.0759332,0.488006,0.623551,0.18354,0.478941,0.396877,0.295499,0.46951],      
    [0.871586,0.218736,0.630348,0.575462,0.364997,0.618027,0.265688,0.518001,0.605138],     
    [0.835476,0.338138,0.0887562,0.613199,0.447925,0.0795077,0.379099,0.563552,0.0697672],  
    [0.565095,0.0478726,0.0179178,0.439741,0.109788,0.0127021,0.305143,0.176268,0.00710174],
    [0.878186,0.273197,0.832193,0.547358,0.4366,0.818428,0.202662,0.606852,0.804086],       
    [0.895653,0.249684,0.975243,0.551514,0.419662,0.960924,0.194215,0.596139,0.946058],     
    [0.876938,0.252093,0.123918,0.652562,0.362917,0.114582,0.415344,0.480083,0.104712],     
    [0.875811,0.448853,0.185499,0.58965,0.590194,0.173592,0.287782,0.739292,0.161032],      
    [0.577093,0.0324844,0.493189,0.354409,0.142473,0.483924,0.123449,0.256549,0.474314],    
    [0.517803,0.0306899,0.263674,0.344155,0.116458,0.256448,0.161399,0.206725,0.248844],    
    [0.875786,0.417735,0.126564,0.604869,0.551547,0.115292,0.318784,0.69285,0.103388],      
    [0.865355,0.302224,0.817443,0.529841,0.467941,0.803483,0.179816,0.640826,0.788919],     
    [0.860847,0.200797,0.736088,0.556724,0.351009,0.723434,0.239679,0.507604,0.710243],     
    [0.788982,0.0914042,0.591685,0.543886,0.212462,0.581487,0.289142,0.338285,0.570888],    
    [0.848722,0.18427,0.0286161,0.673143,0.270992,0.0213106,0.487543,0.362664,0.0135881],   
    [0.842888,0.209725,0.869309,0.533836,0.362372,0.85645,0.213181,0.52075,0.843108],       
    [0.674553,0.0749543,0.0793405,0.542808,0.140026,0.0738589,0.403831,0.208669,0.0680763], 
    [0.885696,0.139302,0.764483,0.592309,0.284211,0.752275,0.287527,0.434749,0.739594],     
    [0.471821,0.0269877,0.348857,0.283471,0.120018,0.34102,0.086962,0.217078,0.332844],     
    [0.803582,0.156665,0.546884,0.53736,0.288157,0.535807,0.258739,0.425774,0.524214],      
    [0.619741,0.0325147,0.384495,0.413504,0.134379,0.375914,0.197848,0.240896,0.366941],    
    [0.704433,0.0369759,0.0362392,0.556571,0.110008,0.0300869,0.397941,0.188358,0.0234866], 
    [0.866722,0.155507,0.639563,0.599286,0.287599,0.628435,0.320871,0.425114,0.616851],     
    [0.8825,0.120935,0.776847,0.585274,0.26774,0.76448,0.276625,0.420189,0.751638],         
    [0.904758,0.402513,0.910572,0.536325,0.584489,0.895242,0.152186,0.774223,0.879259],     
    [0.944002,0.409369,0.0223194,0.713024,0.523454,0.0127088,0.470224,0.643377,0.00260633], 
    [0.911834,0.589727,0.953617,0.551204,0.767849,0.938611,0.17699,0.952681,0.923041],      
    [0.594389,0.0883991,0.085991,0.471659,0.149018,0.0808844,0.342513,0.212806,0.0755108],  
    [0.779105,0.0782183,0.496818,0.550463,0.191149,0.487305,0.312124,0.308869,0.477388],    
    [0.533497,0.0339092,0.035131,0.402759,0.098483,0.0296913,0.261789,0.168111,0.0238258]],

    "TA": [[0.512401,0.378127,0.112714,0.540315,0.350504,0.304157,0.573462,0.317703,0.53149],      
    [0.473886,0.314613,0.14154,0.500707,0.288072,0.325484,0.533077,0.256039,0.54749],       
    [0.338721,0.354839,0.141189,0.362339,0.331467,0.303166,0.390228,0.303869,0.494437],     
    [0.303213,0.29714,0.169726,0.327838,0.272772,0.338609,0.357738,0.243183,0.543676],      
    [0.753864,0.666726,0.125243,0.789718,0.631246,0.371139,0.830817,0.590576,0.653006],     
    [0.0949907,0.358005,0.180144,0.113737,0.339454,0.30871,0.135551,0.317868,0.458318],     
    [0.336908,0.431375,0.102198,0.363767,0.404796,0.286403,0.395492,0.373402,0.503979],     
    [0.195788,0.466149,0.173288,0.221792,0.440416,0.35163,0.252259,0.410268,0.560579],      
    [0.133236,0.416503,0.135489,0.158386,0.391616,0.307971,0.188492,0.361824,0.514446],     
    [0.321892,0.69506,0.105708,0.353018,0.664258,0.31918,0.388615,0.629033,0.563315],       
    [0.513557,0.640021,0.0863498,0.545771,0.608143,0.307284,0.582808,0.571493,0.56129],     
    [0.562216,0.623963,0.102133,0.593762,0.592746,0.318484,0.629887,0.556999,0.566236],     
    [0.406043,0.40428,0.166892,0.430614,0.379966,0.335407,0.459084,0.351793,0.530662],      
    [0.161441,0.479657,0.140676,0.184984,0.456359,0.30214,0.212228,0.4294,0.488985],        
    [0.389423,0.416881,0.0910765,0.414968,0.391604,0.266265,0.444983,0.361902,0.472118],    
    [0.591209,0.523424,0.0806931,0.622239,0.492718,0.293503,0.65831,0.457023,0.540887],     
    [0.558568,0.524325,0.167878,0.588341,0.494862,0.372069,0.62264,0.460921,0.6073],        
    [0.557664,0.360425,0.154819,0.583211,0.335145,0.330026,0.61299,0.305677,0.534257],      
    [0.247731,0.535951,0.112152,0.275331,0.508639,0.301438,0.307414,0.476891,0.521471],     
    [0.610949,0.713275,0.0850302,0.645881,0.678708,0.324601,0.685839,0.639167,0.598645],    
    [0.459187,0.39102,0.141772,0.487197,0.363303,0.333872,0.52044,0.330406,0.561866],       
    [0.546576,0.526846,0.178212,0.573933,0.499774,0.365835,0.605072,0.46896,0.579395],      
    [0.836587,0.639768,0.148617,0.870823,0.60589,0.383412,0.909736,0.567382,0.65029],       
    [0.365616,0.341752,0.191631,0.384042,0.323519,0.317999,0.405009,0.302771,0.461796],     
    [0.392103,0.488691,0.15518,0.422345,0.458764,0.362591,0.457936,0.423544,0.606684],      
    [0.208429,0.550749,0.0813487,0.236206,0.523262,0.271852,0.268669,0.491138,0.494494],    
    [0.656552,0.69892,0.092951,0.690814,0.665016,0.327929,0.72987,0.626367,0.595785],       
    [0.557658,0.618451,0.170166,0.590865,0.585591,0.397905,0.629024,0.547829,0.659612],     
    [0.122777,0.357735,0.100914,0.143383,0.337344,0.242237,0.167772,0.313209,0.409505],     
    [0.188338,0.554963,0.0987755,0.214884,0.528694,0.280834,0.245606,0.498293,0.491532],    
    [0.203031,0.466908,0.144487,0.22976,0.440458,0.327801,0.261293,0.409254,0.544066],      
    [0.174875,0.400657,0.169887,0.200532,0.375267,0.345853,0.231187,0.344932,0.556092],     
    [0.139355,0.48548,0.148033,0.161562,0.463504,0.300336,0.186988,0.438344,0.474715],      
    [0.417916,0.410289,0.0724154,0.444824,0.383661,0.256959,0.476743,0.352075,0.475869],    
    [0.24563,0.619899,0.142866,0.275969,0.589877,0.350939,0.311057,0.555155,0.591583],      
    [0.205773,0.547887,0.117565,0.232994,0.52095,0.304256,0.264592,0.489682,0.520963],      
    [0.23296,0.533866,0.176406,0.256156,0.510912,0.335489,0.28241,0.484932,0.515544],       
    [0.29834,0.306254,0.0938578,0.321659,0.283178,0.253785,0.349973,0.255159,0.447973],     
    [0.377259,0.412895,0.166392,0.405616,0.384833,0.360872,0.439312,0.351489,0.591966],     
    [0.715712,0.678727,0.118694,0.751347,0.643465,0.363084,0.792151,0.603087,0.642929],     
    [0.168377,0.483403,0.0831734,0.194155,0.457893,0.259968,0.224572,0.427794,0.468572],    
    [0.22949,0.621168,0.177833,0.258365,0.592594,0.375865,0.291516,0.559788,0.603228],      
    [0.348936,0.346445,0.194182,0.369917,0.325683,0.338074,0.39412,0.301734,0.50406],       
    [0.0813586,0.434708,0.107964,0.103188,0.413107,0.257673,0.128737,0.387824,0.432896],    
    [0.133639,0.356495,0.0812499,0.155675,0.334688,0.232384,0.18218,0.308461,0.414156],     
    [0.681232,0.583917,0.148307,0.714368,0.551127,0.375566,0.752467,0.513425,0.636856],     
    [0.404509,0.409145,0.123294,0.431014,0.382917,0.305071,0.462244,0.352013,0.519254],     
    [0.645622,0.700061,0.11383,0.68009,0.665953,0.350217,0.71936,0.627093,0.619543],        
    [0.512458,0.536303,0.185073,0.539114,0.509925,0.367888,0.569371,0.479984,0.575397],     
    [0.741921,0.670462,0.123398,0.777169,0.635583,0.365132,0.817471,0.595701,0.641538],     
    [0.253213,0.619296,0.126465,0.280736,0.59206,0.315225,0.31222,0.560905,0.531146],       
    [0.627168,0.605089,0.0977669,0.658917,0.573671,0.315509,0.695327,0.537641,0.565219],    
    [0.312479,0.700455,0.0799391,0.344583,0.668686,0.300115,0.381499,0.632155,0.553294],    
    [0.146671,0.415785,0.103078,0.17007,0.392631,0.263552,0.197817,0.365173,0.453852],      
    [0.106604,0.427743,0.102646,0.128659,0.405919,0.253902,0.154493,0.380354,0.431081],     
    [0.70719,0.677476,0.156188,0.73902,0.645977,0.374489,0.774881,0.610491,0.620431],       
    [0.524106,0.372028,0.138674,0.548415,0.347972,0.305393,0.576647,0.320035,0.499013],     
    [0.655851,0.502658,0.0959633,0.687009,0.471825,0.309655,0.723241,0.435971,0.558144],    
    [0.387312,0.347607,0.0696852,0.412419,0.322762,0.241879,0.442541,0.292954,0.44846],     
    [0.297936,0.704806,0.0797094,0.33004,0.673037,0.299884,0.366958,0.636505,0.553076]],

    "TB":  [[0.103713,0.494255,0.166136,0.12784,0.47038,0.331602,0.155771,0.442741,0.523163],       
    [0.0668144,0.429664,0.20084,0.0895804,0.407135,0.356975,0.116205,0.380788,0.539577],    
    [0.0188838,0.456805,0.0731433,0.0427052,0.433232,0.236516,0.0710754,0.405158,0.431086], 
    [0.0100893,0.437641,0.288875,0.0398751,0.408166,0.493154,0.0761484,0.372272,0.741926],  
    [0.123046,0.571773,0.124616,0.147905,0.547173,0.295108,0.176393,0.518982,0.490486],     
    [0.593811,0.435956,0.0834196,0.622761,0.407308,0.281968,0.656696,0.373728,0.514699],    
    [0.0137655,0.436785,0.286497,0.0410574,0.409778,0.473672,0.073729,0.377447,0.697742],   
    [0.787061,0.552441,0.148415,0.817464,0.522356,0.356923,0.852003,0.488178,0.593801],     
    [0.579619,0.432685,0.157598,0.604693,0.407873,0.329563,0.633293,0.379571,0.525707],     
    [0.863465,0.632047,0.145974,0.894904,0.600935,0.361593,0.930293,0.565915,0.604302],     
    [0.00872791,0.364825,0.366639,0.0395822,0.334293,0.578246,0.0781373,0.29614,0.842667],  
    [0.0397575,0.441629,0.161985,0.0651339,0.416518,0.336024,0.0954162,0.386552,0.543707],  
    [0.0125193,0.379868,0.206438,0.0381595,0.354496,0.382285,0.0695052,0.323477,0.597262],  
    [0.773945,0.555217,0.159532,0.806548,0.522955,0.383129,0.84388,0.486012,0.639165],      
    [0.0531373,0.513821,0.121259,0.0790569,0.488172,0.299023,0.10955,0.457996,0.508155],    
    [0.0641449,0.375511,0.0975636,0.0850556,0.354818,0.240975,0.109902,0.330231,0.411377],  
    [0.0720203,0.510915,0.0944349,0.0962021,0.486985,0.26028,0.124448,0.459034,0.454001],   
    [0.168108,0.558049,0.127784,0.195258,0.531182,0.313986,0.226808,0.499961,0.530365],     
    [0.869536,0.631635,0.132179,0.904947,0.596593,0.375038,0.945434,0.556529,0.652704],     
    [0.0277341,0.442564,0.188109,0.0440636,0.426405,0.300101,0.0623342,0.408325,0.425405],  
    [0.0571912,0.368209,0.19038,0.0760426,0.349554,0.319667,0.0979802,0.327846,0.470121],   
    [0.0442924,0.372094,0.189846,0.0595256,0.35702,0.294319,0.0766908,0.340034,0.412043],   
    [0.142774,0.566957,0.114223,0.168189,0.541807,0.288523,0.197392,0.512909,0.488803],     
    [0.0552931,0.433177,0.199941,0.0713792,0.417258,0.310264,0.0893807,0.399445,0.433723],  
    [0.00789593,0.365011,0.36727,0.0391952,0.334039,0.581928,0.0784255,0.295218,0.850979],  
    [0.636223,0.415579,0.160418,0.665802,0.386309,0.363276,0.700433,0.352039,0.600785],     
    [0.0283676,0.376223,0.195906,0.0445491,0.36021,0.306883,0.0629559,0.341995,0.433122],   
    [0.0266828,0.438566,0.230844,0.0545141,0.411025,0.421718,0.0881108,0.377779,0.652132],  
    [0.780954,0.553534,0.155569,0.811771,0.523039,0.366918,0.846859,0.488317,0.607559],     
    [0.740574,0.563569,0.175047,0.773327,0.531158,0.399675,0.810869,0.494008,0.657146],     
    [0.689712,0.490999,0.111777,0.718914,0.462102,0.312051,0.752523,0.428844,0.542549],     
    [0.69399,0.491381,0.095399,0.725392,0.460306,0.310768,0.761951,0.424129,0.561497],      
    [0.795494,0.657676,0.0922018,0.830247,0.623286,0.330545,0.869918,0.584028,0.602624],    
    [0.0554749,0.442012,0.111839,0.0804385,0.417309,0.283046,0.110279,0.387779,0.4877],     
    [0.825463,0.643677,0.14264,0.857393,0.61208,0.361626,0.893413,0.576437,0.608659],       
    [0.760635,0.556856,0.182483,0.788289,0.52949,0.372142,0.819343,0.498761,0.585116],      
    [0.612976,0.430817,0.0779098,0.642011,0.402085,0.277041,0.676088,0.368363,0.510754],    
    [0.038695,0.520944,0.0932506,0.0632944,0.496602,0.26196,0.0921218,0.468075,0.459665],   
    [0.0178315,0.371588,0.272854,0.0452618,0.344444,0.460978,0.0790794,0.310979,0.692908],  
    [0.0720045,0.438272,0.100271,0.0956364,0.414887,0.262344,0.12374,0.387077,0.455083],    
    [0.685792,0.484702,0.185695,0.718057,0.452772,0.406983,0.755586,0.415635,0.664364],     
    [0.536126,0.365165,0.171265,0.564981,0.336612,0.369158,0.59939,0.302562,0.605142],      
    [0.00895768,0.387462,0.141661,0.033167,0.363506,0.307695,0.0626507,0.33433,0.509902],   
    [0.417623,0.334091,0.114329,0.440931,0.311027,0.274177,0.468414,0.28383,0.462666],      
    [0.627279,0.420672,0.136295,0.653032,0.395188,0.31291,0.682657,0.365873,0.516085],      
    [0.126582,0.485357,0.186933,0.153521,0.458699,0.37169,0.185312,0.427241,0.589716],      
    [0.064702,0.511315,0.111991,0.0908588,0.485431,0.291381,0.121662,0.45495,0.502634],     
    [0.0214754,0.388041,0.0990966,0.0430695,0.366672,0.247195,0.0688728,0.341138,0.42416],  
    [0.0209996,0.455872,0.0760598,0.0449046,0.432217,0.240007,0.0733965,0.404022,0.435411], 
    [0.0443202,0.374309,0.167876,0.0660863,0.352771,0.317154,0.0920923,0.327036,0.495509],  
    [0.533754,0.372148,0.109087,0.560656,0.345526,0.293592,0.592382,0.314131,0.511175],     
    [0.0553109,0.376254,0.116245,0.0762753,0.355508,0.260025,0.101263,0.330781,0.431399],   
    [0.709753,0.480119,0.160545,0.738686,0.451489,0.358973,0.771816,0.418704,0.586188],     
    [0.548801,0.365508,0.130561,0.575046,0.339537,0.310555,0.605904,0.309001,0.52219],      
    [0.586481,0.437886,0.085881,0.614985,0.40968,0.281367,0.648315,0.376698,0.509953],      
    [0.0874702,0.500241,0.154604,0.112519,0.475454,0.326393,0.141704,0.446573,0.526554],    
    [0.101873,0.43104,0.0838867,0.125202,0.407954,0.243886,0.152855,0.38059,0.433532],      
    [0.169246,0.555583,0.148904,0.19701,0.528109,0.339315,0.229266,0.49619,0.560534],       
    [0.0711571,0.433861,0.146438,0.0909398,0.414285,0.282113,0.113675,0.391787,0.438036],   
    [0.622156,0.417444,0.183348,0.646762,0.393095,0.352103,0.674787,0.365363,0.544299]]
}

var redColor = '#da2500';
var greenColor = '#008f00';
var blueColor = '#011993';
var greyColor = '#888888';
var purpleColor = '#5c32a8';
var magentaColor = '#fc0377';
var cyanColor = '#42f5e6';
var yellowColor = '#f5d442';
var brightYellowColor = '#fcd303'; 
var orangeColor = '#DC7B2E';
var blueGreenColor = '#63BFAB'; 
var oRedColor = 'rgba(218, 37, 0, 0.3)';
var oGreenColor = 'rgba(0, 143, 0, 0.3)';
var oBlueColor = 'rgba(1, 25, 147, 0.5)';

// https://docs.mathjax.org/en/v2.1-latest/typeset.html
var QUEUE = MathJax.Hub.queue; // shorthand for the queue
var transMatText;
QUEUE.Push(function () {
  transMatText = MathJax.Hub.getAllJax('mat');
});

function unpack(rows, key, toNum) {
  return rows.map(function(row) {
      if (toNum == false) return row[key];
      else return parseFloat(row[key]);
    });
}

function range(start, end, stride) {
  return Array((end - start) / stride + 1).fill().map((_, idx) => start + idx*stride)
}

var rgb2dkl = [[0.14376143, 0.16556473, 0.00228754], [-0.21244303, -0.7142423, -0.06559153], [ 0.2125915, 0.71517139, 0.07219711]];
var dkl2rgb = math.inv(rgb2dkl);

function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(c) {
  return "#" + componentToHex(c[0]) + componentToHex(c[1]) + componentToHex(c[2]);
}

function RGB2sRGB(color) {
  var out = [];
  for(var i = 0; i < 3; i++) {
    if (color[i] <= 0.0031308) out[i] = parseInt((12.92 * color[i] * 255).toFixed());
    else out[i] = parseInt(((1.055 * Math.pow(color[i], 1/2.4) - 0.055) * 255).toFixed());
  }

  return rgbToHex(out);
}

function getVertices() {
  var o = [0, 0, 0];
  var r = math.multiply(rgb2dkl, math.transpose([1, 0, 0]));
  var g = math.multiply(rgb2dkl, math.transpose([0, 1, 0]));
  var b = math.multiply(rgb2dkl, math.transpose([0, 0, 1]));

  var rg = math.add(r, g);
  var rb = math.add(r, b);
  var gb = math.add(g, b);

  var rgb = math.add(math.add(r, g), b);

  return math.transpose([o,r,g,b,rg,rb,gb,rgb]);
}

function plotRGB(plotId) {
  var allPoints = math.transpose([[0, 0, 0], [1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 1, 0], [1, 0, 1], [0, 1, 1], [1, 1, 1]]);

  var traces = [];

  // O: 0; R: 1; G: 2: B: 3
  // RG: 4; RB: 5; GB: 6; RGB: 7
  var indices = [[0, 1], [0, 2], [0, 3], [1, 4], [1, 5], [2, 4], [2, 6], [3, 5], [3, 6], [4, 7], [5, 7], [6, 7]];
  var names = ['O', 'R', 'G', 'B', 'R+G', 'R+B', 'G+B', 'R+G+B (W)'];
  var hoverInfo = [true, true, true, 'skip', 'skip', 'skip', 'skip', 'skip', 'skip', true, true, true];
  var colors = ['#000000', redColor, greenColor, blueColor, yellowColor, cyanColor, magentaColor, '#000000'];
  var modes = Array(3).fill('lines+markers+text').concat(Array(6).fill('lines')).concat(Array(3).fill('lines+markers+text'));

  // plot the RGB cube
  for (var i = 0; i < indices.length; i++) {
    var start = indices[i][0];
    var end = indices[i][1];
    var line = {
      x: [allPoints[0][start], allPoints[0][end]],
      y: [allPoints[1][start], allPoints[1][end]],
      z: [allPoints[2][start], allPoints[2][end]],
      text: [names[start], names[end]],
      mode: modes[i],
      type: 'scatter3d',
      showlegend: false,
      line: {
        width: 2,
        color: '#000000',
      },
      marker: {
        size: 6,
        opacity: 1,
        color: [colors[start], colors[end]],
      },
      hoverinfo: hoverInfo[i],
    };
    // hovertemplate overwrites hoverinfo, so add it later
    if (hoverInfo[i] == true) {
      line.hovertemplate = '%{text}<br>L-M: %{x}' +
        '<br>S-(L+M): %{y}' +
        '<br>L+M: %{z}<extra></extra>';
    }
    traces.push(line);
  }

  var newLUT = math.concat(lut["PA"], lut["PB"], 0);
  for (var i = 0; i < newLUT.length; i++) {
    var tData = newLUT[i];

    var line = {
      x: [tData[0], tData[3], tData[6]],
      y: [tData[1], tData[4], tData[7]],
      z: [tData[2], tData[5], tData[8]],
      //x: newPoints[0],
      //y: newPoints[1],
      //z: newPoints[2],
      type: 'scatter3d',
      marker: {
        size: 3,
        opacity: 1,
        color: greyColor,
      },
      //mode: 'markers',
      showlegend: true,
      name: i,
      opacity:0.8,
      hovertemplate: 'R: %{x}' +
        '<br>G: %{y}' +
        '<br>B: %{z}<extra></extra>',
    };
    traces.push(line)
  }

  var data = traces;

  var layout = {
    height: 600,
    margin: {
      l: 0,
      r: 0,
      b: 0,
      t: 0
    },
    showlegend: true,
    legend: {
      x: 0.1,
      xanchor: 'left',
      y: 1,
    },
    //title: 'Spectral locus in RGB color space',
    paper_bgcolor: 'rgba(0, 0, 0, 0)',
    scene: {
      camera: {
        projection: {
          type: 'orthographic'
        }
      },
      // https://plotly.com/javascript/3d-axes/
      aspectmode: 'cube',
      xaxis: {
        //autorange: true,
        range: [-0.3, 1.3],
        zeroline: true,
        zerolinecolor: '#000000',
        zerolinewidth: 5,
        //constrain: 'domain',
        //dtick: 0.02,
        showspikes: false,
        title: {
          text: 'R'
        }
      },
      yaxis: {
        //autorange: true,
        range: [-0.3, 1.3],
        zeroline: true,
        zerolinecolor: '#000000',
        zerolinewidth: 5,
        scaleanchor: 'x',
        //scaleratio: 1,
        //dtick: 0.02,
        showspikes: false,
        title: {
          text: 'G'
        }
      },
      zaxis: {
        //autorange: true,
        range: [-0.3, 1.3],
        zeroline: true,
        zerolinecolor: '#000000',
        zerolinewidth: 5,
        scaleanchor: 'x',
        //dtick: 0.02,
        showspikes: false,
        title: {
          text: 'B'
        }
      },
    }
  };
 
  var plot = document.getElementById(plotId);
  Plotly.newPlot(plot, data, layout);

  return plot;
}

plotRGB('rgbDiv');

function updatePlot(theta, plotId) {
  var u = 1/Math.sqrt(3)
  //var theta = Math.PI/4
  var cos = Math.cos(theta)
  var sin = Math.sin(theta)
  
  var rotMat = [
    [cos + u*u*(1-cos), u*u*(1-cos)-u*sin, u*u*(1-cos)+u*sin],
    [u*u*(1-cos)+u*sin, cos+u*u*(1-cos), u*u*(1-cos)-u*sin],
    [u*u*(1-cos)-u*sin, u*u*(1-cos)+u*sin, cos+u*u*(1-cos)]
  ];

  var newLUT = math.concat(lut["PA"], lut["PB"], 0);
  var x = [], y = [], z = [];
  for (var i = 0; i < newLUT.length; i++) {
    var tData = newLUT[i];
    var newPoints = math.multiply(rotMat, [[tData[0], tData[3], tData[6]], [tData[1], tData[4], tData[7]], [tData[2], tData[5], tData[8]]]);
    x.push(newPoints[0]);
    y.push(newPoints[1]);
    z.push(newPoints[2]);
  }

  var data_update = {'x': x, 'y': y, 'z': z};

  var plot = document.getElementById(plotId);
  var updateList = Array.from(plot.data.keys()).slice(12)
  Plotly.update(plot, data_update, {}, updateList);
}

function registerSlider(id) {
  $('input[type=range]').change(function() {
    //console.log(this.value);
    $('.form-label').html(this.value)
    updatePlot(this.value, 'rgbDiv')
  });
}

registerSlider("customRange");





